{
  "hash": "513b49acfa834bc2c0571a52aaf103f3",
  "result": {
    "markdown": "---\ntitle: \"Regressão\"\nauthor: \"Yuri\"\nformat: html\n\nexecute: \n  freeze: auto\n  cache: true\n  warning: false\n---\n\n\n## Análise de regressão\n\n\n::: {.cell hash='aula13_cache/html/unnamed-chunk-1_fdedaadecc9f74fac352e7c314300c1d'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\n\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n\nestande |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  facet_wrap(~exp)+\n  ylim(0, max(estande$nplants))+\n  geom_smooth(se =  FALSE, method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](aula13_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nUma regressão para cada experimento:\n\n\n::: {.cell hash='aula13_cache/html/unnamed-chunk-2_bbde332dc935c13ad987f6758450e5c5'}\n\n```{.r .cell-code}\nexp1 <- estande |> \n  filter(exp==1)\nm1 <- lm(nplants ~trat, data = exp1)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,\tAdjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n```\n:::\n\n```{.r .cell-code}\nexp2 <- estande |> \n  filter(exp==2)\nm2 <- lm(nplants ~trat, data = exp2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n\n```{.r .cell-code}\nexp3 <- estande |> \n  filter(exp==3)\nm3 <- lm(nplants ~trat, data = exp3)\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,\tAdjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n```\n:::\n\n```{.r .cell-code}\nlibrary(report)\nreport(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWe fitted a linear model (estimated using OLS) to predict nplants with trat\n(formula: nplants ~ trat). The model explains a statistically not significant\nand weak proportion of variance (R2 = 0.07, F(1, 22) = 1.69, p = 0.207, adj. R2\n= 0.03). The model's intercept, corresponding to trat = 0, is at 52.50 (95% CI\n[43.78, 61.22], t(22) = 12.49, p < .001). Within this model:\n\n  - The effect of trat is statistically non-significant and negative (beta =\n-0.24, 95% CI [-0.63, 0.14], t(22) = -1.30, p = 0.207; Std. beta = -0.27, 95%\nCI [-0.69, 0.16])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n:::\n\n```{.r .cell-code}\ng2 <- exp1 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_smooth(method = \"lm\", se = F)+\n    annotate(geom =\"text\", x = 24,\n             y=70, label = \"y = 52.5 - 0.24x\")\n\n(52.5+60+95+69)/4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 69.125\n```\n:::\n:::\n\n\nModelo linear generalizado:\n\n\n::: {.cell hash='aula13_cache/html/unnamed-chunk-3_2e131f5df9b3e4c06ebdd83008e7bcbe'}\n\n```{.r .cell-code}\nglm1 <- glm(nplants ~ trat, family= \"gaussian\",\n            data = exp3)\n\nglm2 <- glm(nplants ~ trat, family= poisson(link = \"log\"),\n            data = exp3)\nsummary(glm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = \"gaussian\", data = exp3)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 110.9787)\n\n    Null deviance: 6235.8  on 23  degrees of freedom\nResidual deviance: 2441.5  on 22  degrees of freedom\nAIC: 185.04\n\nNumber of Fisher Scoring iterations: 2\n```\n:::\n\n```{.r .cell-code}\nsummary(glm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nplants ~ trat, family = poisson(link = \"log\"), \n    data = exp3)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.571590   0.029539 154.762  < 2e-16 ***\ntrat        -0.009965   0.001488  -6.697 2.13e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 77.906  on 23  degrees of freedom\nResidual deviance: 29.952  on 22  degrees of freedom\nAIC: 183.93\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\nAIC(glm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 185.0449\n```\n:::\n\n```{.r .cell-code}\nAIC(glm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 183.9324\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}